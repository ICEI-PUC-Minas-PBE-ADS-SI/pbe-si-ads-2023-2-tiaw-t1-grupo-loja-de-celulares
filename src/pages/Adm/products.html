<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />

    <title>Produtos</title>
  </head>

  <body>
    <header class="py-2">
      <div class="container d-flex align-items-center justify-content-between">
        <a href="/src/pages/Adm/home.html">
          <img
            src="../../assets/Images/logomelhor.png"
            height="100px"
            class="me-3"
            alt=""
          />
        </a>

        <div>
          <div
            class="ms-3 ms-xl-5 d-none align-items-center gap-2 d-lg-flex justify-content-center"
            style="width: fit-content"
          >
            <i
              class="bi bi-person-circle text-white"
              style="font-size: 1.7rem"
            ></i>
            <p class="text-white m-0 fw-bolder">Administrador</p>
          </div>

          <nav class="ms-auto justify-content-end d-flex gap-3">
            <a
              class="position-relative text-end d-none d-lg-block cart-link"
              href="https://www.instagram.com/alphacellbetim/"
              target="_blank"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              data-bs-title="Instagram"
            >
              <i
                class="bi bi-instagram text-white"
                style="font-size: 1.7rem !important"
              ></i>
            </a>
            <button
              onclick="confirmLogout()"
              class="d-none d-lg-block btn cart-link m-0 p-0 border-0"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              data-bs-title="Logout"
            >
              <i
                class="bi bi-box-arrow-in-left text-white"
                style="font-size: 1.9rem !important"
              ></i>
            </button>
          </nav>
        </div>

        <button
          class="btn d-block d-lg-none p-0 border-0"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasRight"
          aria-controls="offcanvasRight"
        >
          <i class="bi bi-list text-white" style="font-size: 3rem"></i>
        </button>
      </div>
    </header>

    <main>
      <div class="container">
        <div class="mt-5 d-flex align-items-center justify-content-between">
          <h2>Produtos</h2>
          <div>
            <a href="/src/pages/Adm/home.html" class="btn btn-outline-primary"
              ><i class="bi bi-arrow-bar-left"></i> Voltar
            </a>
          </div>
        </div>
        <div class="d-flex align-items-center justify-content-end mt-2">
          <div>
            <button
              class="btn btn-outline-primary"
              data-bs-toggle="modal"
              data-bs-target="#cadastroModal"
            >
              <i class="bi bi-plus"></i> Adiconar produto
            </button>
          </div>
        </div>
        <table class="table mt-5">
          <thead style="background-color: rgb(251, 146, 54);">
            <tr>
              <th scope="col">#</th>
              <th scope="col" style="text-align: center">Imagem</th>
              <th scope="col" style="text-align: center">Nome do Produto</th>
              <th scope="col" style="text-align: center">Unidade em Estoque</th>
              <th scope="col" style="text-align: center">Categoria</th>
              <th scope="col" style="text-align: center">Preço</th>
              <th scope="col" style="text-align: center">Ações</th>
            </tr>
          </thead>
          <tbody id="tabela-corpo" style="text-align: center">
            
          </tbody>
        </table>
      </div>
    </main>

    <!--Modal para cadastro de produtos-->

    <!-- Modal -->
    <div
      class="modal fade"
      id="cadastroModal"
      tabindex="-1"
      aria-labelledby="cadastroModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" style="max-width: 500px">
        <div class="modal-content">
          <div class="modal-header">
            <button
              type="button"
              style="background-color: rgb(251, 146, 54)"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <!-- Formulário de cadastro de produto -->
            <form id="produtoForm">
              <div class="mb-3" style="display: flex; justify-content: center">
                <input
                  type="text"
                  style="width: 80%"
                  class="form-control"
                  id="nomeProduto"
                  placeholder="Nome do Produto"
                  required
                />
              </div>
              <div class="mb-3" style="display: flex; justify-content: center">
                <input
                  type="file"
                  class="form-control"
                  id="imagemProduto"
                  accept="image/*"
                  style="display: none"
                />
                <img
                  id="imagemPlaceholder"
                  src="/src/assets/Images/placeholder.png"
                  class="img-fluid"
                  alt="Imagem do Produto"
                  style="width: 80%; cursor: pointer"
                />
              </div>
              <div class="mb-3" style="display: flex; justify-content: center">
                <textarea
                  style="width: 80%"
                  class="form-control text-center"
                  id="descricaoProduto"
                  rows="3"
                  placeholder="Digite a descrição do produto"
                  required
                ></textarea>
              </div>
              <div
                class="row mb-3"
                style="display: flex; justify-content: center"
              >
                <div class="col input-group" style="padding-left: 11.5%">
                  <span class="input-group-text">Preço</span>
                  <input
                    type="text"
                    class="form-control text-center"
                    id="precoProduto"
                    placeholder="R$ 0,00"
                    required
                  />
                </div>
                <div class="col">
                  <select
                    class="form-select"
                    id="categoriaProduto"
                    style="width: 77%"
                    required
                  >
                    <option value="" disabled selected>Categoria</option>
                    <option value="Celular">Celular</option>
                    <option value="Fone">Fone</option>
                    <option value="Caixa de som">Caixa de som</option>
                    <option value="Bateria">Bateria</option>
                    <option value="Mouse/Teclado">Mouse/Teclado</option>
                    <option value="Capinha/película">Capinha/Película</option>
                  </select>
                </div>
              </div>
              <div
                style="display: flex; justify-content: center; padding: 6% 0"
              >
                <button
                  type="submit"
                  class="btn text-white btn-block"
                  style="
                    width: 80%;
                    height: 45px;
                    background-color: rgb(251, 146, 54);
                  "
                >
                  Cadastrar
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div class="container mt-4">
      <div class="row" id="products-container">
        <!-- Os cards dos produtos serão adicionados aqui -->
      </div>
    </div>
    
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <style>
      :root {
        --primary: rgb(251, 146, 54) !important;
      }

      header {
        background-color: rgb(251, 146, 54);
      }

      main.container {
        margin-bottom: 5rem !important;
      }

      .cart-link {
        transition: all 300ms;
      }

      .cart-link.btn {
        transform: translateY(-1px);
      }

      .cart-link:hover {
        transform: scale(1.2);
      }

      .cart-link.btn:hover {
        transform: scale(1.2) translateY(-1px);
      }

      .btn-outline-primary {
        border-color: rgb(251, 146, 54) !important;
        color: rgb(251, 146, 54) !important;
        font-weight: 700;
      }

      .btn-outline-primary:is(:hover, :focus) {
        background-color: rgb(251, 146, 54) !important;
        border-color: rgb(251, 146, 54) !important;
        color: #fff !important;
      }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="../../js/seed.js"></script>

    <script>
 if (typeof seed !== 'undefined') {
      // Referência ao corpo da tabela
      const tabelaCorpo = document.getElementById('tabela-corpo');

      // Preencha a tabela com os dados do seed.js
      seed.stock.products.forEach((produto, index) => {
        const newRow = tabelaCorpo.insertRow();

        // Adicione as células conforme a ordem das colunas
        newRow.insertCell(0).textContent = index + 1;
        newRow.insertCell(1).innerHTML = `<img
                  src="${produto.img}"
                  alt=""
                  width="100px"
                />`;
        newRow.insertCell(2).textContent = produto.name;
        newRow.insertCell(3).innerHTML =`<strong> ${produto.quantity +" Unidades"} </strong>`;
        newRow.insertCell(4).textContent = produto.category;
        newRow.insertCell(5).innerHTML = `<strong>R$ ${produto.price}</strong>`;
        newRow.insertCell(6).innerHTML = `
          <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#cadastroModal">
            Editar
          </button>
        `;
      });
    } else {
      console.error('O objeto "seed" não está definido. Verifique o carregamento do arquivo seed.js.');
    }

      const tooltipTriggerList = document.querySelectorAll(
        '[data-bs-toggle="tooltip"]'
      );
      const tooltipList = [...tooltipTriggerList].map(
        (tooltipTriggerEl) => new bootstrap.Tooltip(tooltipTriggerEl)
      );

      const confirmLogout = () => {
        Swal.fire({
          title: "Você tem certeza?",
          text: "Você tem certeza de que deseja sair do sistema?",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#3085d6",
          cancelButtonColor: "#d33",
          confirmButtonText: "Sim, desejo!",
          cancelButtonText: "Não, cancelar.",
        }).then((result) => {
          if (result.isConfirmed) {
            window.location = "/src/pages/Auth/login.html";
            return;
          }
        });
      };

      AOS.init({
        // Global settings:
        disable: false, // accepts following values: 'phone', 'tablet', 'mobile', boolean, expression or function
        startEvent: "DOMContentLoaded", // name of the event dispatched on the document, that AOS should initialize on
        initClassName: "aos-init", // class applied after initialization
        animatedClassName: "aos-animate", // class applied on animation
        useClassNames: false, // if true, will add content of `data-aos` as classes on scroll
        disableMutationObserver: false, // disables automatic mutations' detections (advanced)
        debounceDelay: 50, // the delay on debounce used while resizing window (advanced)
        throttleDelay: 99, // the delay on throttle used while scrolling the page (advanced)

        // Settings that can be overridden on per-element basis, by `data-aos-*` attributes:
        offset: 120, // offset (in px) from the original trigger point
        delay: 0, // values from 0 to 3000, with step 50ms
        duration: 800, // values from 0 to 3000, with step 50ms
        easing: "ease", // default easing for AOS animations
        once: false, // whether animation should happen only once - while scrolling down
        mirror: false, // whether elements should animate out while scrolling past them
        anchorPlacement: "top-bottom",
      });

      // Criação de produtos

      var produtos = [];

      // Função para exibir a imagem selecionada no modal
      document
        .getElementById("imagemPlaceholder")
        .addEventListener("click", function () {
          document.getElementById("imagemProduto").click();
        });

      document
        .getElementById("imagemProduto")
        .addEventListener("change", function () {
          var imagemPreview = document.getElementById("imagemPlaceholder");
          var file = this.files[0];

          if (file) {
            var reader = new FileReader();
            reader.onload = function (event) {
              imagemPreview.src = event.target.result;
            };
            reader.readAsDataURL(file);
          } else {
            imagemPreview.src = "placeholder.jpg";
          }
        });

      // Função para adicionar um novo produto ao array e criar um card
      function adicionarProduto(nome, descricao, preco, categoria, imagem) {
        var produto = {
          nome: nome,
          descricao: descricao,
          preco: preco,
          categoria: categoria,
          imagem: imagem,
        };
        produtos.push(produto);

        var card = document.createElement("div");
        card.className = "";
        card.innerHTML = `
            <div class="container">
            
        <table class="table mt-5">
          <tbody>
            <tr>
              <th scope="row"> </th>
              <td><img src="${imagem}" alt="" width="100px"></td>
              <td>${nome}</td>
              <td class="text-center"><strong>50 unidades</strong></td>
              <td class="text-center">
                ${categoria}
              </td>
              <td><strong>${preco}</strong></td>
              <td>
                <button
                  class="btn btn-sm btn-primary"
                  data-bs-toggle="modal" 
                  data-bs-target="#cadastroModal"
                >
                  Editar
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    `;
        document.getElementById("products-container").appendChild(card);
      }

      document
        .getElementById("produtoForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          var nomeProduto = document.getElementById("nomeProduto").value;
          var descricaoProduto =
            document.getElementById("descricaoProduto").value;
          var precoProduto = document.getElementById("precoProduto").value;
          var categoriaProduto =
            document.getElementById("categoriaProduto").value;
          var imagemProduto = document.getElementById("imagemProduto").files[0];

          if (imagemProduto) {
            var reader = new FileReader();
            reader.onload = function (event) {
              var imagemBase64 = event.target.result;
              adicionarProduto(
                nomeProduto,
                descricaoProduto,
                precoProduto,
                categoriaProduto,
                imagemBase64
              );
            };
            reader.readAsDataURL(imagemProduto);
          } else {
            adicionarProduto(
              nomeProduto,
              descricaoProduto,
              precoProduto,
              categoriaProduto,
              "caminho_da_imagem_padrao.png"
            );
          }

          var modal = new bootstrap.Modal(
            document.getElementById("cadastroModal")
          );
          modal.hide();

          document.getElementById("nomeProduto").value = "";
          document.getElementById("descricaoProduto").value = "";
          document.getElementById("precoProduto").value = "";
          document.getElementById("categoriaProduto").value = "";
          document.getElementById("imagemProduto").value = "";
        });
    </script>
    <div class="container"></div>
  </body>
</html>
